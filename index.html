<!-- This goes in the document HEAD so IE7 and IE8 don't cry -->
<!--[if lt IE 9]>
<style type="text/css">
  table.gradienttable th {
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#d5e3e4', endColorstr='#b3c8cc',GradientType=0 );
    position: relative;
    z-index: -1;
  }
  table.gradienttable td {
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ebecda', endColorstr='#ceceb7',GradientType=0 );
    position: relative;
    z-index: -1;
  }
</style>
<![endif]-->


<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7" prefix="og: http://ogp.me/ns#"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8" prefix="og: http://ogp.me/ns#"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en" prefix="og: http://ogp.me/ns#"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Meta Data Science</title>
  <meta name="author" content="Massoud Seifi">

  
  <meta name="description" content="Random Sampling Random sampling from a set of entities means any entity has the same chance of selection as any other such entities.
Suppose we want &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://metadatascience.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Meta Data Science" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Oswald:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Avenir:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<meta property="og:title" content="Meta Data Science By Massoud Seifi, Ph.D. Data Scientist" />
<meta property="og:image" content="/images/metadatascience.gif" />
<link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [ ['$', '$'], ["\\(", "\\)"] ],
        displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
      //,
      //displayAlign: "left",
      //displayIndent: "2em"
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-38669216-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
	var sc_project=8892392; 
	var sc_invisible=1; 
	var sc_security="3020fdf3"; 
	var scJsHost = (("https:" == document.location.protocol) ? "https://secure." : "http://www.");
	document.write("<sc"+"ript type='text/javascript' src='" + scJsHost+ "statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript>
	<div class="statcounter">
		<a title="web analytics" href="http://statcounter.com/" target="_blank">
			<img class="statcounter" src="http://c.statcounter.com/8892392/0/3020fdf3/1/" alt="web analytics">
		</a>
	</div>
</noscript>
<!-- End of StatCounter Code for Default Guide -->
</head>


<body   >
  <header role="banner"><hgroup>
  <h1><a href="/"><img src='/images/logo.png' alt='logo' height="71" width="85"/>   Meta Data Science</a></h1>
  
    <h2><span style="font-family:Oswald;">By Massoud Seifi, Ph.D. Data Scientist</span></h2>
  

</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:metadatascience.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/archives">Archives</a></li>
  <li><a href="/publications">Publications</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/02/27/random-sampling-from-very-large-files/">Random Sampling From Very Large Files</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-27T14:49:00-08:00" pubdate data-updated="true">Feb 27<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3 id="random-sampling">Random Sampling</h3>

<p><a href="http://en.wikipedia.org/wiki/Sampling_(statistics)">Random sampling</a> from a set of entities means any entity has the same chance of selection as any other such entities.
Suppose we want to randomly select $k$ lines from a large text file containing hundreds of millions of lines. We desire that the probability of being selected be the same for every line in the file.</p>

<h3 id="algorithm-1">Algorithm 1</h3>

<p>The first approach which comes in mind is to </p>

<ul>
  <li>Count the number of lines in the file, </li>
  <li>Create a sorted random set of $k$ integers between 1 and number of lines in the file,</li>
  <li>Iterate over the random integers and read the file line by line. 
Pick the line if the line number matches one of the the random integers.</li>
</ul>

<p>This algorithm in Python is shown below.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Random Sampling 1  (random_sampler1.py)</span> <a href="/downloads/code/random_sampler1.py">download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">random</span>
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">random_sampler</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span class="line">	<span class="n">sample</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class="line">	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span class="line">		<span class="n">linecount</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">)</span>
</span><span class="line">		<span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">		<span class="n">random_linenos</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">xrange</span><span class="p">(</span><span class="n">linecount</span><span class="p">),</span> <span class="n">k</span><span class="p">),</span> <span class="n">reverse</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</span><span class="line">		<span class="n">lineno</span> <span class="o">=</span> <span class="n">random_linenos</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span class="line">		<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
</span><span class="line">			<span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="n">lineno</span><span class="p">:</span>
</span><span class="line">				<span class="n">sample</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
</span><span class="line">				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">random_linenos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span class="line">					<span class="n">lineno</span> <span class="o">=</span> <span class="n">random_linenos</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span class="line">				<span class="k">else</span><span class="p">:</span>
</span><span class="line">					<span class="k">break</span>
</span><span class="line">	<span class="k">return</span> <span class="n">sample</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h3 id="algorithm-2-reservoir-sampling">Algorithm 2: Reservoir sampling</h3>

<p>As you see, in previous algorithm, we scan the file two times. First time for counting the number of lines in the file, and second time to select random lines. 
There are some algorithms which even work without knowing in advance the total number of items. One classical algorithm form Alan Waterman called <a href="http://en.wikipedia.org/wiki/Reservoir_sampling">Reservoir sampling</a> is exposed in the second volume of Donald Knuth’s “<a href="http://en.wikipedia.org/wiki/The_Art_of_Computer_Programming">The Art of Computer Programming</a>”. </p>

<p>Suppose we want to select $k$ items from a set of items. We start by filling the “reservoir” with the first $k$ items, and then for each $i^{th}$ item remaining in the set, we generate a random number $r$ between $1$ and $i$. If $r$ is less than $k$, we replace the $r^{th}$ item of the reservoir with the $i^{th}$ item of the set. We continue processing items until we reach the end of the set. </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Random Sampling 2  (random_sampler2.py)</span> <a href="/downloads/code/random_sampler2.py">download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">random</span>
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">random_sampler</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span class="line">	<span class="n">sample</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class="line">	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span class="line">		<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
</span><span class="line">			<span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
</span><span class="line">				<span class="n">sample</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
</span><span class="line">			<span class="k">else</span><span class="p">:</span>
</span><span class="line">				<span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span class="line">				<span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
</span><span class="line">					<span class="n">sample</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
</span><span class="line">	<span class="k">return</span> <span class="n">sample</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>It is easy to prove by induction that this approach works and each line has the same probability of being selected as the other lines:</p>

<p>Suppose we need to collect a random sample of $k$ items from a list of items coming as an online stream. We desire that after seeing $n$ item, each item in the sample set had $\frac{k}{n}$ chance to be there.</p>

<p>For example, suppose $k=10$. According to the algorithm, the first $10$ items go directly to the reservoir. So for them, the probability of being selected is $\frac{10}{10} = 1 \checkmark$.</p>

<p>Now, suppose the $11^{th}$ item comes. The desired probability is now $\frac{k}{n} = \frac{10}{11}$. We have:</p>

<ul>
  <li>
    <p>According to the reservoir sampling algorithm above, the probability of $11^{th}$ item to being selected is $\frac{10}{11} \checkmark$.</p>
  </li>
  <li>
    <p>For the items already in the reservoir, the chance of being in the sample set and also remaining in the sample set after seeing the $11^{th}$ item, is their previous probability to be there, multiple the probability of not being replace by the $11^{th}$. So we have:</p>

    <p>Pr = Probability that a selected item remains in the reservoir</p>

    <p>= Previous probability to be there * Probability of not being replaced</p>

    <p>= Previous probability to be there * ( 1 - Probability of being replaced by $11^{th}$ item)</p>

    <p>The chance that an item in the reservoir being replaced with $11^{th}$ item is the probability of $11^{th}$ item to be selected, which is $\frac{10}{11}$, multiple the probability of being the replacement candidate between 10 items, which is $\frac{1}{10}$. So we have: <script type="math/tex">Pr = \frac{10}{10}*(1-\frac{10}{11}*\frac{1}{10})=\frac{10}{11} \checkmark</script>.</p>
  </li>
</ul>

<p>Likewise, for the $12^{th}$ item we have:</p>

<ul>
  <li>
    <p>Probability of $12^{th}$ item to being selected is $\frac{10}{12} \checkmark$.</p>
  </li>
  <li>
    <p>For the items already in the reservoir: <script type="math/tex">Pr = \frac{10}{11}*(1-\frac{10}{12}*\frac{1}{10})=\frac{10}{12} \checkmark</script></p>
  </li>
</ul>

<p>And this can be extended for the $n^{th}$ item. Although reservoir sampling is an interesting approach but it is too slow for our problem here.</p>

<h3 id="algorithm-3">Algorithm 3</h3>

<p>There is another interesting approach when the lines have approximately the same length (for example, we deal with a huge list of email addresses). In this case, there is a correlation between line numbers and the file size. So, we can use the algorithm below:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Random Sampling 3  (random_sampler3.py)</span> <a href="/downloads/code/random_sampler3.py">download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">random</span>
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">random_sampler</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span class="line">	<span class="n">sample</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class="line">	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span class="line">		<span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span class="line">		<span class="n">filesize</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
</span><span class="line">
</span><span class="line">		<span class="n">random_set</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">xrange</span><span class="p">(</span><span class="n">filesize</span><span class="p">),</span> <span class="n">k</span><span class="p">))</span>
</span><span class="line">
</span><span class="line">		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
</span><span class="line">			<span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">random_set</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span class="line">			<span class="c"># Skip current line (because we might be in the middle of a line) </span>
</span><span class="line">			<span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span><span class="line">			<span class="c"># Append the next line to the sample set </span>
</span><span class="line">			<span class="n">sample</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
</span><span class="line">
</span><span class="line">	<span class="k">return</span> <span class="n">sample</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Basically, we get the file size. Create a sorted random set of k random positions in the file (between 1 and the file size). For each random position, we seek that position, skip a line, and put the next line to the sample set.</p>

<h3 id="benchmark">Benchmark</h3>

<p>The table below shows the elapsed time for selecting 1000 lines from a large (~ 40M lines) and a very large file(~ 300M lines) for each algorithm. We see that the algorithm 3 is much faster. As I mentioned before, the only assumption is that the lines should have approximately the same length.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Algorithm</th>
      <th style="text-align: right">File 1 (~ 40M lines)</th>
      <th style="text-align: right">File 2 (~ 300M lines)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">random_sampler1.py</td>
      <td style="text-align: right">6.641s</td>
      <td style="text-align: right">1m14.184s</td>
    </tr>
    <tr>
      <td style="text-align: left">random_sampler2.py</td>
      <td style="text-align: right">50.406s</td>
      <td style="text-align: right">6m51.078s</td>
    </tr>
    <tr>
      <td style="text-align: left">random_sampler3.py</td>
      <td style="text-align: right">0.019s</td>
      <td style="text-align: right">3.119s</td>
    </tr>
  </tbody>
</table>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/08/13/how-to-get-twitter-username-from-twitter-id/">How to Get Twitter Username From Twitter ID</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-08-13T11:18:00-07:00" pubdate data-updated="true">Aug 13<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3 id="twitter-id-and-username">Twitter ID and Username</h3>

<p>The Twitter ID is a unique number identifying an account on Twitter. 
Upon registration, users can also choose a username (a.k.a. screen name or @handle).
However an account can never change its Twitter ID, but it can change its username.</p>

<h3 id="getting-twitter-username-from-twitter-id-using-the-twitter-api-rate-limited">Getting Twitter username from Twitter ID using the Twitter API (rate limited)</h3>

<p>I was trying to lookup some Twitter IDs and find out what their corresponding usernames are. My first approach was using the code below using 
<code>http://twitter.com/users/show/[ID]?format=json</code> as the endpoint:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Getting Twitter username from Twitter ID using the Twitter API (limited)  (TwitterUserIdToScreenName_limited.php)</span> <a href="/downloads/code/TwitterUserIdToScreenName_limited.php">download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
</pre></td><td class="code"><pre><code class="php"><span class="line"><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class="line"><span class="sd">/**</span>
</span><span class="line"><span class="sd"> * Getting the Twitter usename from Twitter ID</span>
</span><span class="line"><span class="sd"> * This approach does not work in large scale. It&#39;s limited to 150 requests per hour.</span>
</span><span class="line"><span class="sd"> *</span>
</span><span class="line"><span class="sd"> * @author Massoud Seifi, Ph.D. @ MetaDataScience.com</span>
</span><span class="line"><span class="sd"> */</span>
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">TwitterUserIdToScreenName</span> <span class="p">{</span>
</span><span class="line">
</span><span class="line">	<span class="k">protected</span> <span class="nv">$href_base</span> <span class="o">=</span> <span class="s1">&#39;http://twitter.com/users/show/&#39;</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">	<span class="k">public</span> <span class="k">function</span> <span class="nf">getScreenNameFromUserId</span><span class="p">(</span><span class="nv">$twitter_user_id</span><span class="p">){</span>
</span><span class="line">
</span><span class="line">		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$twitter_user_id</span><span class="p">)){</span>
</span><span class="line">		    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class="line">		<span class="p">}</span>
</span><span class="line">
</span><span class="line">		<span class="nv">$href</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">href_base</span> <span class="o">.</span> <span class="nv">$twitter_user_id</span> <span class="o">.</span> <span class="s1">&#39;?format=json&#39;</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">		<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
</span><span class="line">		<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$href</span><span class="p">);</span>
</span><span class="line">		<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span>         <span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</span><span class="line">		<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span> <span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class="line">		<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_FOLLOWLOCATION</span> <span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">		<span class="nv">$result</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span><span class="line">		<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">		<span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class="line">		
</span><span class="line">		<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$json</span><span class="p">[</span><span class="s1">&#39;screen_name&#39;</span><span class="p">])){</span>
</span><span class="line">			<span class="k">return</span> <span class="nv">$json</span><span class="p">[</span><span class="s1">&#39;screen_name&#39;</span><span class="p">];</span>
</span><span class="line">		<span class="p">}</span>
</span><span class="line">
</span><span class="line">	<span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nv">$p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TwitterUserIdToScreenName</span><span class="p">();</span>
</span><span class="line">
</span><span class="line"><span class="k">while</span> <span class="p">(</span><span class="nv">$line</span> <span class="o">=</span> <span class="nb">fgets</span><span class="p">(</span><span class="nx">STDIN</span><span class="p">)){</span>
</span><span class="line">	<span class="nv">$id</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>
</span><span class="line">	<span class="nv">$screen_name</span> <span class="o">=</span> <span class="nv">$p</span><span class="o">-&gt;</span><span class="na">getScreenNameFromUserId</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
</span><span class="line">	<span class="k">if</span> <span class="p">(</span> <span class="nb">is_string</span><span class="p">(</span><span class="nv">$screen_name</span><span class="p">)</span> <span class="p">){</span>
</span><span class="line">		<span class="k">echo</span> <span class="s2">&quot;</span><span class="si">$id</span><span class="s2">,</span><span class="si">$screen_name</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>This code calls Twitter API which has two issues:</p>

<ol>
  <li>
    <p>It needs an access token after the release of Twitter API version 1.1.</p>
  </li>
  <li>
    <p>The number of requests is limited to 150 requests per hour.</p>
  </li>
</ol>

<h3 id="getting-twitter-username-from-twitter-id-without-using-the-twitter-api-scalable">Getting Twitter username from Twitter ID without using the Twitter API (scalable)</h3>

<p>I tried another approach using <code>http://twitter.com/account/redirect_by_id?id=</code> which doesn’t call the Twitter API and consequently has no rate limit. This approach worked fine for me and I could easily look up thousands of Twitter IDs. Here is the code:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Getting Twitter username from Twitter ID without using the Twitter API  (TwitterUserIdToScreenName.php)</span> <a href="/downloads/code/TwitterUserIdToScreenName.php">download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
</pre></td><td class="code"><pre><code class="php"><span class="line"><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class="line"><span class="sd">/**</span>
</span><span class="line"><span class="sd"> * Getting the Twitter usename from Twitter ID</span>
</span><span class="line"><span class="sd"> * This code works fine in large scale.</span>
</span><span class="line"><span class="sd"> *</span>
</span><span class="line"><span class="sd"> * @author Massoud Seifi, Ph.D. @ MetaDataScience.com</span>
</span><span class="line"><span class="sd"> */</span>
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">TwitterUserIdToScreenName</span> <span class="p">{</span>
</span><span class="line">
</span><span class="line">	<span class="k">protected</span> <span class="nv">$href_base</span> <span class="o">=</span> <span class="s1">&#39;http://twitter.com/account/redirect_by_id?id=&#39;</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">	<span class="k">public</span> <span class="k">function</span> <span class="nf">getScreenNameFromUserId</span><span class="p">(</span><span class="nv">$twitter_user_id</span><span class="p">)</span>
</span><span class="line">	<span class="p">{</span>
</span><span class="line">
</span><span class="line">		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$twitter_user_id</span><span class="p">)){</span>
</span><span class="line">		    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class="line">		<span class="p">}</span>
</span><span class="line">
</span><span class="line">		<span class="nv">$href</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">href_base</span> <span class="o">.</span> <span class="nv">$twitter_user_id</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">		<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
</span><span class="line">		<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$href</span><span class="p">);</span>
</span><span class="line">		<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_NOBODY</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class="line">		<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span>         <span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class="line">		<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span> <span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class="line">		<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_FOLLOWLOCATION</span> <span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">		<span class="nv">$result</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span><span class="line">		<span class="nv">$info</span> <span class="o">=</span>  <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span><span class="line">		<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">		<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$info</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">])){</span>
</span><span class="line">			<span class="k">return</span>  <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">parse_url</span><span class="p">(</span><span class="nv">$info</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">],</span> <span class="nx">PHP_URL_PATH</span><span class="p">));</span>
</span><span class="line">		<span class="p">}</span>
</span><span class="line">
</span><span class="line">	<span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nv">$p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TwitterUserIdToScreenName</span><span class="p">();</span>
</span><span class="line">
</span><span class="line"><span class="k">while</span> <span class="p">(</span><span class="nv">$line</span> <span class="o">=</span> <span class="nb">fgets</span><span class="p">(</span><span class="nx">STDIN</span><span class="p">)){</span>
</span><span class="line">	<span class="nv">$id</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>
</span><span class="line">	<span class="nv">$screen_name</span> <span class="o">=</span> <span class="nv">$p</span><span class="o">-&gt;</span><span class="na">getScreenNameFromUserId</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
</span><span class="line">	<span class="k">if</span> <span class="p">(</span> <span class="nb">is_string</span><span class="p">(</span><span class="nv">$screen_name</span><span class="p">)</span> <span class="p">){</span>
</span><span class="line">		<span class="k">echo</span> <span class="s2">&quot;</span><span class="si">$id</span><span class="s2">,</span><span class="si">$screen_name</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Usage Example:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">&gt; echo 1180576736 | php TwitterUserIdToScreenName.php
</span><span class="line">1180576736,AccessToken</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>or you can lookup a list of IDs:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">&gt; cat list_IDs | php TwitterUserIdToScreenName.php</span></code></pre></td></tr></table></div></figure></notextile></div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/07/03/plotting-the-frequency-distribution-using-r/">Plotting the Frequency Distribution Using R</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-07-03T12:22:00-07:00" pubdate data-updated="true">Jul 3<span>rd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3 id="introduction">Introduction</h3>

<p><a href="http://www.r-project.org/">R</a> is an open source language and environment for statistical computing and graphics. 
It’s an implementation of the <a href="http://en.wikipedia.org/wiki/S_(programming_language)">S language</a> which was developed at Bell Laboratories by John Chambers and colleagues.
R provides a wide variety of statistical and graphical techniques, including linear and nonlinear modeling, classical statistical tests, time-series analysis, classification, clustering, and others. 
It is also an interpreted language and can be accessed through a command-line interpreter: For example, if a user types “2+2” at the R command prompt and press enter, the computer replies with “4”.
R is freely available under the GNU General Public License.</p>

<h3 id="plotting-the-frequency-distribution">Plotting The Frequency Distribution</h3>

<h4 id="frequency-distribution">Frequency distribution</h4>

<p>A frequency distribution shows the number of occurrences in each category of a categorical variable. 
For example, in a sample set of users with their favourite colors, we can find out how many users like a specific color.</p>

<h4 id="data-set">Data set</h4>

<p>Suppose a data set of 30 records including user ID, favorite color and gender:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Sample Set  (sample.csv)</span> <a href="/downloads/code/sample.csv">download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">ID,Color,Gender
</span><span class="line">792141B,Blue,Male
</span><span class="line">795156A,Blue,Male
</span><span class="line">795156B,Blue,Male
</span><span class="line">795156C,Blue,Male
</span><span class="line">795156E,Blue,Male
</span><span class="line">795156G,Blue,Female
</span><span class="line">795156I,Blue,Male
</span><span class="line">795156J,White,Male
</span><span class="line">795156M,Red,Male
</span><span class="line">795156N,Blue,Male
</span><span class="line">795156O,Green,Male
</span><span class="line">795156P,Red,Male
</span><span class="line">795156Q,Blue,Male
</span><span class="line">795156S,White,Male
</span><span class="line">795156T,Blue,Male
</span><span class="line">795156W,Red,Female
</span><span class="line">800731A,Red,Male
</span><span class="line">800731C,Blue,Male
</span><span class="line">800731E,Blue,Male
</span><span class="line">800731F,Blue,Female
</span><span class="line">800731G,Red,Male
</span><span class="line">800731I,Blue,Female
</span><span class="line">800731K,Blue,Female
</span><span class="line">800731M,Blue,Male
</span><span class="line">800731N,Blue,Female
</span><span class="line">800731O,Blue,Female
</span><span class="line">800731Q,Blue,Male
</span><span class="line">800731W,Blue,Male
</span><span class="line">800731X,Red,Male
</span><span class="line">800731Y,Red,Male
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h4 id="reading-the-csv-file">Reading the csv file</h4>

<p>Let’s start with reading the csv file:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">data &lt;- read.csv(file = &#39;sample.csv&#39;, header = TRUE, sep = &#39;,&#39;)
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The first argument which is mandatory is the name of file. The second argument indicates whether or not the first row is a set of labels and the third argument indicates the delimiter. The above command will read in the csv file and assign it to a variable called “data”.</p>

<p>You can use the following command to see the list of column names:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">names(data)
</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>which results:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">[1] &quot;ID&quot;     &quot;Color&quot;  &quot;Gender&quot;
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Or you can use following command to see a summary of the data:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">summary(data)
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">   ID       Color       Gender
</span><span class="line"> 792141B: 1   Blue :20   Female: 7
</span><span class="line"> 795156A: 1   Green: 1   Male  :23
</span><span class="line"> 795156B: 1   Red  : 7
</span><span class="line"> 795156C: 1   White: 2
</span><span class="line"> 795156E: 1
</span><span class="line"> 795156G: 1
</span><span class="line"> (Other):24
</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>As you see, the number of occurrences of each color is shown in the summary. </p>

<h4 id="table-function">Table function</h4>

<p><em>table()</em>  uses the cross-classifying factors to build a contingency table of the counts at each combination of factor levels.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">table(data$Color)
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="text"><span class="line"> Blue Green   Red White
</span><span class="line">   20     1     7     2
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h4 id="plotting">Plotting</h4>

<p>Now we can plot it easily using the <em>barplot</em> command:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">barplot(table(data$Color))
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h4 id="save-the-plot-as-an-image">Save the plot as an image</h4>

<p>I can see the plot on my machine, but to put it here on my weblog, I have to save it as an image:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">dev.copy(png, &#39;freq.png&#39;)
</span><span class="line">dev.off()
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Here you go…</p>

<p><img class="center" src="/images/freq.png" width="380" height="380" /></p>

<h4 id="factor">Factor</h4>

<p>The <em>factor</em> function is used to create a factor (or category) from a vector. </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">factor(data$Color)
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">[1] Blue  Blue  Blue  Blue  Blue  Blue  Blue  White Red   Blue  Green Red
</span><span class="line">[13] Blue  White Blue  Red   Red   Blue  Blue  Blue  Red   Blue  Blue  Blue
</span><span class="line">[25] Blue  Blue  Blue  Blue  Red   Red
</span><span class="line">Levels: Blue Green Red White
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Levels is a unique set of values in the vector.</p>

<p>Now, suppose that “Yellow” was also an option for the users but nobody has chosen it as the favourite color. 
We can use the <em>factor</em> command to customize the categories:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">factor(data$Color, levels = c(&#39;Blue&#39;, &#39;Green&#39;, &#39;Yellow&#39;, &#39;Red&#39;, &#39;White&#39;))
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="text"><span class="line"> [1] Blue  Blue  Blue  Blue  Blue  Blue  Blue  White Red   Blue  Green Red
</span><span class="line">[13] Blue  White Blue  Red   Red   Blue  Blue  Blue  Red   Blue  Blue  Blue
</span><span class="line">[25] Blue  Blue  Blue  Blue  Red   Red
</span><span class="line">Levels: Blue Green Yellow Red White
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Now, we can see Yellow in the frequency distribution:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">table(factor(data$Color, levels = c(&#39;Blue&#39;,&#39;Green&#39;,&#39;Yellow&#39;,&#39;Red&#39;,&#39;White&#39;)))
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">  Blue  Green Yellow    Red  White
</span><span class="line">    20      1      0      7      2
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>And we can see it on the plot:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">barplot(table(factor(data$Color, levels = c(&#39;Blue&#39;, &#39;Green&#39;, &#39;Yellow&#39;, &#39;Red&#39;, &#39;White&#39;))))
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><img class="center" src="/images/freq1.png" width="380" height="380" /></p>

<p>if you want to see the percentages instead of the values, you can try this:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">t &lt;- table(factor(data$Color, levels = c(&#39;Blue&#39;, &#39;Green&#39;, &#39;Yellow&#39;, &#39;Red&#39;, &#39;White&#39;)))
</span><span class="line">barplot(t / sum(t))
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><img class="center" src="/images/freq2.png" width="380" height="380" /></p>

<h4 id="filtering">Filtering</h4>

<p>Now, let’s imagine that we want to plot the frequency distribution of favourite colors for men and women separately. 
The following commands create two subsets of data by filtering the gender and store it to two different variables (Don’t forget the comma!):</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">men &lt;- data[data$Gender == &#39;Male&#39;,]
</span><span class="line">
</span><span class="line">women &lt;- data[data$Gender == &#39;Female&#39;,]
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>now we can plot the distributions seperately:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">l &lt;- c(&#39;Blue&#39;, &#39;Green&#39;, &#39;Yellow&#39;, &#39;Red&#39;, &#39;White&#39;)
</span><span class="line">
</span><span class="line">barplot(table(factor(men$Color, levels = l, main = &#39;Men&#39;)
</span><span class="line">
</span><span class="line">barplot(table(factor(women$Color, levels = l, main = &#39;Women&#39;)
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><img src="/images/freq_men.png" width="380" height="380" /><img src="/images/freq_women.png" width="380" height="380" /></p>

<h4 id="colors-and-labels">Colors and Labels</h4>

<p>Do you like colors and labels?! Here you go…</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="text"><span class="line">l &lt;- c(&#39;Blue&#39;,&#39;Green&#39;,&#39;Yellow&#39;,&#39;Red&#39;,&#39;White&#39;)
</span><span class="line">
</span><span class="line">barplot(table(factor(data$Color, levels = l)) , col = c(&#39;blue&#39;, &#39;green&#39;, &#39;yellow&#39;, &#39;red&#39;, &#39;white&#39;), xlab = &#39;Favourite Color&#39;, ylab = &#39;Number Of Users&#39;)
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><img class="center" src="/images/freq3.png" width="480" height="480" /></p>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/./page/2/">&larr; Older</a>
    
    <a href="/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>
  	I am a Data Scientist with a formal background in Computer Science and Mathematics (especially Graph Theory).
  	I have a high curiosity to make discoveries in the world of big data and a passion to find innovative solutions for complex challenges.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/02/27/random-sampling-from-very-large-files/">Random sampling from very large files</a>
      </li>
    
      <li class="post">
        <a href="/2013/08/13/how-to-get-twitter-username-from-twitter-id/">How to get Twitter username from Twitter ID</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/03/plotting-the-frequency-distribution-using-r/">Plotting the frequency distribution using R</a>
      </li>
    
      <li class="post">
        <a href="/2013/03/14/lookup-table-for-inferring-facebook-account-creation-date-from-facebook-user-id/">Lookup Table for Inferring Facebook Account Creation Date From Facebook User ID</a>
      </li>
    
      <li class="post">
        <a href="/2013/03/11/inferring-facebook-account-creation-date-from-facebook-user-id/">Inferring Facebook account creation date from Facebook User ID</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Latest Tweets</h1>
  <a class="twitter-timeline" href="https://twitter.com/AccessToken" data-widget-id="352835310855528450">Tweets by @AccessToken</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Massoud Seifi -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'metadatascience';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
